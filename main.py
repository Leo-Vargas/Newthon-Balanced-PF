import numpy as np
from functions import updateAVvalues, JacobianCalculatorV2, calculatePQ


# ----------------------- CONFIG ---------------------------
np.set_printoptions(precision=3)
stopCondition = 0.0001
maxIter = 5
baseMVA = 100





# ----------------------- entry data 30 bus-----------------------

Ybus = np.array([
(6.46838346734966 - 20.6959477620055j, -5.22464617988566 + 15.6467268408034j, -1.24373728746401 + 5.09602092120209j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j),
(-5.22464617988566 + 15.6467268408034j, 9.75228216552403 - 30.6486628926761j, 0.00000000000000 + 0.00000000000000j, -1.70553031669903 + 5.19737922825651j, -1.13596078817388 + 4.77247932828136j, -1.68614488076547 + 5.11647749533481j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j),
(-1.24373728746401 + 5.09602092120209j, 0.00000000000000 + 0.00000000000000j, 9.43918632977612 - 28.6022935502649j, -8.19544904231211 + 23.5308726290628j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j),
(0.00000000000000 + 0.00000000000000j, -1.70553031669903 + 5.19737922825651j, -8.19544904231211 + 23.5308726290628j, 16.3141030891857 - 55.8200477304928j, 0.00000000000000 + 0.00000000000000j, -6.41312373017456 + 22.3112035654812j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 4.74646293582023j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j),
(0.00000000000000 + 0.00000000000000j, -1.13596078817388 + 4.77247932828136j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 4.08998082413586 - 12.1188472450551j, 0.00000000000000 + 0.00000000000000j, -2.95402003596198 + 7.44926791677370j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j),
(0.00000000000000 + 0.00000000000000j, -1.68614488076547 + 5.11647749533481j, 0.00000000000000 + 0.00000000000000j, -6.41312373017456 + 22.3112035654812j, 0.00000000000000 + 0.00000000000000j, 18.4741606772999 - 67.0448396645865j, -3.59021042398099 + 11.0261144107281j, -6.28930817610063 + 22.0125786163522j, 0.00000000000000 + 4.73431049501951j, 0.00000000000000 + 1.86785870919009j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, -0.495373466278286 + 0.0147121179186223j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j),
(0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, -2.95402003596198 + 7.44926791677370j, -3.59021042398099 + 11.0261144107281j, 6.54423045994298 - 18.3848823275018j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j),
(0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, -6.28930817610063 + 22.0125786163522j, 0.00000000000000 + 0.00000000000000j, 7.73328723749608 - 26.5276932748284j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, -1.44397906139545 + 4.54081465847625j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j),
(0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 4.73431049501951j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 - 11.4139457664638j, 0.00000000000000 + 1.79856115107914j, 0.00000000000000 + 4.80769230769231j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j),
(0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 1.86785870919009j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 1.79856115107914j, 13.4620428145242 - 34.4714127276924j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, -3.95603912571535 + 10.3174477198441j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, -1.78483031526663 + 3.98535828943083j, -5.10185382015965 + 10.9807141129298j, -2.61931955338260 + 5.40077030332945j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j),
(0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 4.80769230769231j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 - 4.80769230769231j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j),
(0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 4.74646293582023j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 6.57396158377616 - 19.9813139751750j, 0.00000000000000 + 1.79856115107914j, -1.52656760883956 + 3.17342527296542j, -3.09539618265643 + 6.09727586432626j, -1.95199779228017 + 4.10435937911185j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j),
(0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 1.79856115107914j, 0.00000000000000 - 1.79856115107914j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j),
(0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, -1.52656760883956 + 3.17342527296542j, 0.00000000000000 + 0.00000000000000j, 4.62196379149599 - 9.27070113729168j, -3.09539618265643 + 6.09727586432626j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j),
(0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, -3.09539618265643 + 6.09727586432626j, 0.00000000000000 + 0.00000000000000j, -3.09539618265643 + 6.09727586432626j, 9.96684093197897 - 19.8620405912426j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, -1.80769961776445 + 3.69142398580871j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, -1.96834894890166 + 3.97606487678136j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j),
(0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, -1.95199779228017 + 4.10435937911185j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 3.81980085692792 - 8.48372287534904j, -1.86780306464775 + 4.37936349623719j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j),
(0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, -3.95603912571535 + 10.3174477198441j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, -1.86780306464775 + 4.37936349623719j, 5.82384219036310 - 14.6968112160812j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j),
(0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, -1.80769961776445 + 3.69142398580871j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 4.88338605177317 - 9.91018278508768j, -3.07568643400872 + 6.21875879927897j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j),
(0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, -3.07568643400872 + 6.21875879927897j, 8.95803937518519 - 17.9834646816319j, -5.88235294117647 + 11.7647058823529j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j),
(0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, -1.78483031526663 + 3.98535828943083j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, -5.88235294117647 + 11.7647058823529j, 7.66718325644310 - 15.7500641717838j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j),
(0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, -5.10185382015965 + 10.9807141129298j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 21.8764951898959 - 45.1084327617036j, -16.7746413697362 + 34.1277186487737j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j),
(0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, -2.61931955338260 + 5.40077030332945j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, -16.7746413697362 + 34.1277186487737j, 21.9344990753744 - 43.4828918151792j, 0.00000000000000 + 0.00000000000000j, -2.54053815225556 + 3.95440286307604j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j),
(0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, -1.96834894890166 + 3.97606487678136j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 3.42975455538499 - 6.96530361731543j, -1.46140560648333 + 2.98923874053408j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j),
(0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, -2.54053815225556 + 3.95440286307604j, -1.46140560648333 + 2.98923874053408j, 5.31183670261313 - 9.27126365731517j, -1.30989294387425 + 2.28762205370506j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j),
(0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, -1.30989294387425 + 2.28762205370506j, 4.49571508032199 - 7.86497876196962j, -1.21653011944949 + 1.81714404634750j, -1.96929201699825 + 3.76021266191706j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j),
(0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, -1.21653011944949 + 1.81714404634750j, 1.21653011944949 - 1.81714404634750j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j),
(0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, -1.96929201699825 + 3.76021266191706j, 0.00000000000000 + 0.00000000000000j, 3.65228147077859 - 9.46044252232512j, 0.00000000000000 + 2.63568784599992j, -0.995533550952680 + 1.88100584035782j, -0.687455902827657 + 1.29397149479772j),
(0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, -0.495373466278286 + 0.0147121179186223j, 0.00000000000000 + 0.00000000000000j, -1.44397906139545 + 4.54081465847625j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 2.63568784599992j, 1.93935252767373 - 7.05287930164740j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j),
(0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, -0.995533550952680 + 1.88100584035782j, 0.00000000000000 + 0.00000000000000j, 1.90758675798496 - 3.60436440120705j, -0.912053207032276 + 1.72335856084923j),
(0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, 0.00000000000000 + 0.00000000000000j, -0.687455902827657 + 1.29397149479772j, 0.00000000000000 + 0.00000000000000j, -0.912053207032276 + 1.72335856084923j, 1.59950910985993 - 3.01733005564695j)
])
#print(Ybus)
#print('\n')
#is_symmetric(Ybus)


busTypes = {
    'SLACK': np.array([1, ]),
    'PV': np.array([2, 5, 8, 11, 13]),
    'PQ': np.array([3, 4, 7, 9, 10, 11, 12, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30])
}

voltages = np.array([1.06, 1.043, 1.0, 1.0, 1.01, 1.0, 1.0, 1.01, 1.0, 1.0, 1.082, 1.0, 1.071, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0])
angles = np.zeros(voltages.shape[0], dtype=float)

loadsMw = np.array([0.0, 21.7, 2.4, 7.6, 94.2, 0.0, 22.8, 30.0, 0.0, 5.8, 0.0, 11.2, 0.0, 6.2, 8.2, 3.5, 9.0, 3.2, 9.5, 2.2, 17.5, 0.0, 3.2, 8.7, 0.0, 3.5, 0.0, 0.0, 2.4, 10.6])
loadsMvar = np.array([0.0, 12.7, 1.2, 1.6, 19.0, 0.0, 10.9, 30.0, 0.0, 2.0, 0.0, 7.5, 0.0, 1.6, 2.5, 1.8, 5.8, 0.9, 3.4, 0.7, 11.2, 0.0, 1.6, 6.7, 0.0, 2.3, 0.0, 0.0, 0.9, 1.9])

generationMw = np.array([0.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0])
generationMvar = np.zeros(generationMw.shape[0], dtype=float)

voltagesEnd = np.array([1.06, 1.043, 1.022, 1.013, 1.01, 1.012, 1.003, 1.01, 1.051, 1.044, 1.082, 1.057, 1.071, 1.042, 1.038, 1.045, 1.039, 1.028, 1.025, 1.029, 1.032, 1.033, 1.027, 1.022, 1.019, 1.001, 1.026, 1.011, 1.006, 0.995])
anglesEnd = np.array([0.0, -5.497, -8.004, -9.661, -14.381, -11.398, -13.158, -12.115, -14.434, -16.024, -14.434, -15.302, -15.302, -16.191, -16.278, -15.88, -16.188, -16.884, -17.052, -16.852, -16.468, -16.455, -16.662, -16.83, -16.424, -16.842, -15.912, -12.057, -17.136, -18.015])



# ---------------------- entry data 3 bus ----------------
"""
Ybus = np.array([
    (20.0-50.0j, -10.0+20.0j, -10.0+30.0j),
    (-10.0+20.0j, 26.0-52.0j, -16.0+32.0j),
    (-10.0+30.0j, -16.0+32.0j, 26.0-62.0j)
])

busTypes = {
    'SLACK': np.array([1, ]),
    'PV': np.array([3, ]),
    'PQ': np.array([2, ]),
}

voltages = np.array([1.05, 1.0, 1.04])
angles = np.zeros(voltages.shape[0], dtype=float)

loadsMw = np.array([0.0, 400.0, 0.0])
loadsMvar = np.array([0.0, 250.0, 0.0])

generationMw = np.array([0.0, 0.0, 200.0])
generationMvar = np.array([0.0, 0.0, 0.0])

"""

# --------------- Calculations ---------------




iterations = 0

iterationAvector = np.zeros(angles.shape[0]-busTypes['SLACK'].shape[0], dtype=float)
iterationVvector = np.ones(voltages.shape[0]-busTypes['SLACK'].shape[0]-busTypes['PV'].shape[0], dtype=float)

scheduledPvector = np.delete((generationMw - loadsMw)/baseMVA, busTypes['SLACK'] - 1)
scheduledQvector = np.delete((generationMvar - loadsMvar)/baseMVA, np.concatenate((busTypes['SLACK'], busTypes['PV']), None) - 1)

scheduledPQvector = np.concatenate((scheduledPvector, scheduledQvector), None)

iterationAVvector = np.concatenate((iterationAvector, iterationVvector), None)
deltaAVvector = np.zeros(iterationAVvector.shape[0])
calculatedPQvector = calculatePQ(Ybus, angles, voltages, busTypes)

print(iterationAVvector)

deltaPQvector = scheduledPQvector - calculatedPQvector



while (any(abs(deltaPQ) > stopCondition for deltaPQ in deltaPQvector)) and (maxIter > iterations):
    iterations+=1
    print(f'iteration {iterations}')

    jacobian = JacobianCalculatorV2(Ybus, voltages, angles, busTypes)

    deltaAVvector = np.linalg.solve(jacobian, deltaPQvector)

    iterationAVvector = iterationAVvector + deltaAVvector

    [angles, voltages] = updateAVvalues(iterationAVvector, angles, voltages, busTypes)
    
    calculatedPQvector = calculatePQ(Ybus, angles, voltages, busTypes)
    deltaPQvector = scheduledPQvector - calculatedPQvector

    print(f'jacobian shape = {jacobian.shape}')
    print(jacobian)
    print(f'deltaAVvector = {deltaAVvector}')
    print(f'iterationAVvector = {iterationAVvector}')
    print(f'voltages = {voltages}')
    print(f'angles = {angles}')
    print(f'delta PQ = {deltaPQvector}')
    print('-------------------------------------------')
    print('')


